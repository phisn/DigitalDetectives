#include "MapManager.h"

namespace
{
/*	
	Game::MapPosition index_map[COMMON_MAP_SIZE] PROGMEM =
	{
		190, 191, 192, 193, 194,   182, 195, 196, 197, 184, // 95 missing
		185, 186, 198, 187, 199,   188, 173, 171, 175, 189, // 135 missing
		178, 179, 180, 181, 166,   183, 167, 168, 169, 170,
		159, 172, 128, 160, 174,   176, 177, 163, 164, 148,
		165, 151, 153, 154, 155,   156, 157, 158, 142, 143, // 153 double
		161, 162, 144, 145, 146,   147, 137, 149, 150, 138,
		152, 139, 140, 133, 141,   134, 118, 129, 135, 136, // 153 double, 135 assumed
		120, 121, 122, 123, 124,   130, 125, 131, 113, 132,
		114, 126, 127, 116, 117,   108, 119, 109, 111, 112,
		100, 101, 115,  92,  93,    94,  95,  96,  97,  98, // 94 double, 95 assumed
		110,  99,  80,  81,  82,    83, 102, 103,  86, 104,
		 87,  88,  89, 105, 106,   107,  73,  74,  75,  59,
		 76,  77,  78,  79,  63,    64,  65,  66,  67,  84,
		 68,  85,  69,  53,  70,    71,  90,  91,  57,  58,
		 45,  60,  46,  61,  62,    48,  35,  36,  49,  50,
		 51,  52,  40,  54,  55,    72,  56,  43,  31,  44,
		 32,  33,  21,  47,  34,    22,  23,  37,  24,  38,
		 39,  27,  28,  41,  29,    42,  30,  18,  19,  20,
		 10,  11,  12,  13,  25,    26,  16,  17,   8,   1,
		  9,   2,   3,   4,  14,    15,   5,   6,   7
	};
*/

	Game::MapPosition index_map[COMMON_MAP_SIZE] PROGMEM =
	{
		189, 191, 192, 193, 196,    197, 198, 188, 190, 180,
		181, 182, 183, 194, 195,    186, 187, 177, 178, 179,
		162, 165, 166, 168, 184,    185, 171, 172, 174, 176,
		158, 160, 161, 164, 146,    147, 167, 169, 170, 152,
		173, 175, 157, 159, 140,    142, 163, 145, 148, 149,
		150, 151, 133, 153, 154,    156, 138, 139, 119, 141,
		143, 144, 124, 125, 126,    127, 128, 130, 132, 134,
		135, 155, 116, 117, 118,    120, 121, 122, 123, 102,
		103, 104, 105, 129, 131,    108, 110, 111, 112, 136,
		137,  93,  94,  95,  96,     97,  98,  99, 101,  90,
		 91, 106, 107, 109, 113,    114, 115,  85,  87, 100,
		 88,  89,  78,  80,  92,     83,  84,  66,  86,  70,
		 71,  72,  73,  74,  76,     81,  82,  32,  67,  75,
		 77,  79,  63,  65,  68,     69,  56,  59,  61,  62,
		 64,  48,  49,  52,  53,     54,  55,  39,  57,  58,
		 41,  60,  42,  43,  44,     45,  46,  47,  30,  33,
		 50,  51,  37,  38,  40,     24,  26,  27,  28,  29,
		 17,  31,  16,  34,  18,     35,  36,  20,  21,  22,
		 23,   5,  25,   9,  10,     11,  13,  15,  19,   0,
		  1,   2,   3,   4,   6,      7,   8,  12,  14,
	};

}

namespace Device
{
	namespace MapManager
	{
		void Initialize()
		{
		}

		void Unintialize()
		{
		}

		Game::MapPosition Translate(const Game::MapPosition position)
		{
			static_assert(sizeof(Game::MapPosition) == 1,
				"Position size changed, need to adopt 'Translate'");
			/*

			for (int i = 0; i < COMMON_MAP_SIZE; ++i)
				if (pgm_read_byte(index_map + i) == position)
				{
					return (Game::MapPosition) i;
				}
			*/

			return (Game::MapPosition) pgm_read_byte(index_map + position - 1);
		}
	}
}
